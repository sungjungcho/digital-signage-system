# 디지털 사이니지 시스템

Next.js 기반의 디지털 사이니지 시스템으로, 다양한 디바이스에서 동적 콘텐츠를 표시하고 관리할 수 있는 솔루션입니다.

## 주요 기능

### 콘텐츠 관리
- **다양한 콘텐츠 타입 지원**: 텍스트, 이미지, 비디오, YouTube 영상
- **복합형 콘텐츠**: 여러 타입의 콘텐츠를 하나로 구성
- **분할 레이아웃**: 왼쪽 콘텐츠 + 오른쪽 정보 패널 (날짜/시간, 공지사항, 대기 환자 명단)
- **스케줄링 기능**: 시간/요일/기간 기반의 콘텐츠 자동 교체
- **실시간 콘텐츠 업데이트**: WebSocket을 통한 즉시 반영

### 디바이스 관리
- **디바이스 등록 및 관리**: 별칭(alias) 기반 URL 접근
- **PIN 코드 인증**: 디바이스별 4자리 PIN 코드로 보안 접근
- **온라인/오프라인 상태 관리**

### 사용자 관리
- **멀티테넌시**: 사용자별 독립적인 디바이스 및 콘텐츠 관리
- **회원가입 승인 시스템**: 슈퍼관리자 승인 후 이용 가능
- **역할 기반 접근 제어**: 일반 사용자 / 슈퍼관리자

### 알림 시스템
- **긴급 알림 브로드캐스트**: 선택된 디바이스에 실시간 알림 전송
- **자동 만료**: 시간 기반 알림 자동 닫기

## 기술 스택

- **프론트엔드**: Next.js 15, React 19, Tailwind CSS
- **백엔드**: Next.js API Routes, Middleware
- **데이터베이스**: SQLite (better-sqlite3)
- **실시간 통신**: WebSocket (ws 라이브러리)
- **인증**: bcryptjs (비밀번호 해싱), 세션 기반 인증

## 프로젝트 구조

```
/src
├── app/                    # App Router 기반 페이지
│   ├── admin/             # 관리자 페이지
│   ├── superadmin/        # 슈퍼관리자 페이지
│   ├── display/[deviceId]/ # 디바이스 디스플레이 페이지
│   ├── initialize-device/  # 디바이스 연결 페이지
│   ├── login/             # 로그인 페이지
│   ├── register/          # 회원가입 페이지
│   └── api/               # API 라우트
│       ├── auth/          # 인증 API
│       ├── devices/       # 디바이스 API
│       ├── contents/      # 콘텐츠 API
│       ├── alerts/        # 알림 API
│       └── superadmin/    # 슈퍼관리자 API
├── components/            # 재사용 가능한 UI 컴포넌트
│   ├── admin/            # 관리자 컴포넌트
│   └── display/          # 디스플레이 컴포넌트
├── lib/                   # 유틸리티 및 공통 로직
│   ├── wsServer.ts       # WebSocket 서버
│   ├── alertStore.ts     # 알림 저장소
│   └── auth.ts           # 인증 유틸리티
├── types/                 # TypeScript 타입 정의
└── middleware.ts          # Next.js 미들웨어 (인증 처리)

/data
└── signage.db            # SQLite 데이터베이스

/public
└── uploads/              # 업로드된 미디어 파일
```

## 시작하기

### 1. 저장소 클론

```bash
git clone https://github.com/yourusername/digital-signage-system.git
cd digital-signage-system
```

### 2. 의존성 설치

```bash
npm install
```

### 3. 데이터베이스 초기화

```bash
node scripts/init-db.js
```

이 스크립트는 SQLite 데이터베이스를 생성하고 필요한 테이블을 초기화합니다.
기본 슈퍼관리자 계정이 생성됩니다:
- 아이디: `superadmin`
- 비밀번호: `admin1234`

### 4. 개발 서버 실행

```bash
npm run dev
```

브라우저에서 [http://localhost:3000](http://localhost:3000)을 열어 확인하세요.

## 사용 방법

### 1. 로그인
- 슈퍼관리자 계정으로 로그인하거나 새 계정을 등록합니다.
- 새 계정은 슈퍼관리자 승인 후 사용 가능합니다.

### 2. 디바이스 등록
- 관리자 페이지에서 새 디바이스를 등록합니다.
- 별칭(alias)는 영문 소문자, 숫자, 하이픈만 사용 가능합니다.
- 4자리 PIN 코드를 설정합니다.

### 3. 콘텐츠 추가
- 텍스트, 이미지, 비디오, YouTube 영상을 추가할 수 있습니다.
- 복합형 콘텐츠로 여러 타입을 조합할 수 있습니다.
- 분할 레이아웃으로 왼쪽 콘텐츠와 오른쪽 정보 패널을 구성할 수 있습니다.

### 4. 디바이스 연결
- `/initialize-device` 페이지에서 디바이스를 선택합니다.
- PIN 코드를 입력하여 인증합니다.
- 디스플레이 페이지에서 콘텐츠가 자동으로 순환 표시됩니다.

### 5. 알림 전송
- 관리자 페이지에서 긴급 알림을 전송할 수 있습니다.
- 대상 디바이스를 선택하고 메시지를 입력합니다.
- 알림은 실시간으로 해당 디바이스에 표시됩니다.

## API 포트

- **웹 서버**: 3000
- **WebSocket 서버**: 3031
- **HTTP 브로드캐스트**: 3032

## 라이선스

MIT License
